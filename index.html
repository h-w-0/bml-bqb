<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>BML表情面板</title>
</head>
<body>
    <!-- 按钮和图片区域会通过JS动态生成 -->
    
    <script>
        // 解析URL参数
        function getQueryParams() {
            const params = {};
            const queryString = window.location.search.slice(1);
            const pairs = queryString.split('&');
            
            pairs.forEach(pair => {
                if (pair) {
                    const [key, value] = pair.split('=');
                    // 解码参数值，处理特殊字符
                    params[key] = decodeURIComponent(value || '');
                }
            });
            return params;
        }

        // 复制到剪贴板函数
        function copyToClipboard(text) {
            const tempInput = document.createElement('input');
            // 隐藏临时输入框
            tempInput.style = 'position: absolute; left: -1000px; top: -1000px';
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            try {
                // 执行复制命令
                const successful = document.execCommand('copy');
                if (successful) {
                    console.log('复制成功');
                }
            } catch (err) {
                console.error('复制失败:', err);
            }
            document.body.removeChild(tempInput);
        }

        // 初始化页面
        function init() {
            const params = getQueryParams();
            const container = document.createElement('div');
            
            // 动态创建按钮和图片
            let i = 1;
            while (params[`btn-${i}`]) {
                const button = document.createElement('button');
                const img = document.createElement('img');
                img.src = params[`btn-${i}`];
                img.style.maxWidth = '100px';
                img.style.maxHeight = '100px';
                
                button.appendChild(img);
                button.id = `button-${i}`;
                
                // 绑定复制事件
                const copyText = params[`fuzhi-${i}`] || '';
                button.addEventListener('click', () => {
                    copyToClipboard(copyText);
                });
                
                container.appendChild(button);
                i++;
            }
            
            document.body.appendChild(container);
        }

        // 页面加载完成后初始化
        window.onload = init;
    </script>
</body>
</html>
